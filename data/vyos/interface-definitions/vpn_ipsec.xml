<?xml version="1.0"?>
<interfaceDefinition>
  <node name="vpn">
    <properties>
      <help>Virtual Private Network (VPN)</help>
    </properties>
    <children>
      <node name="ipsec" owner="${vyos_conf_scripts_dir}/vpn_ipsec.py">
        <properties>
          <help>VPN IP security (IPsec) parameters</help>
          <priority>901</priority>
        </properties>
        <children>
          <node name="authentication">
            <properties>
              <help>Authentication</help>
            </properties>
            <children>
              <tagNode name="psk">
                <properties>
                  <help>Pre-shared key name</help>
                </properties>
                <children>
                  <!-- include start from dhcp-interface-multi.xml.i -->
                  <leafNode name="dhcp-interface">
                    <properties>
                      <help>DHCP interface supplying next-hop IP address</help>
                      <completionHelp>
                        <script>${vyos_completion_dir}/list_interfaces</script>
                      </completionHelp>
                      <valueHelp>
                        <format>txt</format>
                        <description>DHCP interface name</description>
                      </valueHelp>
                      <constraint>
                        <!-- include start from constraint/interface-name.xml.i -->
                        <regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
                        <validator name="file-path --lookup-path /sys/class/net --directory"/>
                        <!-- include end -->
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <leafNode name="id">
                    <properties>
                      <help>ID for authentication</help>
                      <valueHelp>
                        <format>txt</format>
                        <description>ID used for authentication</description>
                      </valueHelp>
                      <multi/>
                    </properties>
                  </leafNode>
                  <leafNode name="secret">
                    <properties>
                      <help>IKE pre-shared secret key</help>
                      <valueHelp>
                        <format>txt</format>
                        <description>IKE pre-shared secret key</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                </children>
              </tagNode>
            </children>
          </node>
          <leafNode name="disable-uniqreqids">
            <properties>
              <help>Disable requirement for unique IDs in the Security Database</help>
              <valueless/>
            </properties>
          </leafNode>
          <tagNode name="esp-group">
            <properties>
              <help>Encapsulating Security Payload (ESP) group name</help>
            </properties>
            <children>
              <leafNode name="compression">
                <properties>
                  <help>Enable ESP compression</help>
                  <valueless/>
                </properties>
              </leafNode>
              <leafNode name="lifetime">
                <properties>
                  <help>Security Association time to expire</help>
                  <valueHelp>
                    <format>u32:30-86400</format>
                    <description>SA lifetime in seconds</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 30-86400"/>
                  </constraint>
                </properties>
                <defaultValue>3600</defaultValue>
              </leafNode>
              <leafNode name="life-bytes">
                <properties>
                  <help>Security Association byte count to expire</help>
                  <valueHelp>
                    <format>u32:1024-26843545600000</format>
                    <description>SA life in bytes</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 1024-26843545600000"/>
                  </constraint>
                </properties>
              </leafNode>
              <leafNode name="life-packets">
                <properties>
                  <help>Security Association packet count to expire</help>
                  <valueHelp>
                    <format>u32:1000-26843545600000</format>
                    <description>SA life in packets</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 1000-26843545600000"/>
                  </constraint>
                </properties>
              </leafNode>
              <leafNode name="mode">
                <properties>
                  <help>ESP mode</help>
                  <completionHelp>
                    <list>tunnel transport</list>
                  </completionHelp>
                  <valueHelp>
                    <format>tunnel</format>
                    <description>Tunnel mode</description>
                  </valueHelp>
                  <valueHelp>
                    <format>transport</format>
                    <description>Transport mode</description>
                  </valueHelp>
                  <constraint>
                    <regex>(tunnel|transport)</regex>
                  </constraint>
                </properties>
                <defaultValue>tunnel</defaultValue>
              </leafNode>
              <leafNode name="pfs">
                <properties>
                  <help>ESP Perfect Forward Secrecy</help>
                  <completionHelp>
                    <list>enable dh-group1 dh-group2 dh-group5 dh-group14 dh-group15 dh-group16 dh-group17 dh-group18 dh-group19 dh-group20 dh-group21 dh-group22 dh-group23 dh-group24 dh-group25 dh-group26 dh-group27 dh-group28 dh-group29 dh-group30 dh-group31 dh-group32 disable</list>
                  </completionHelp>
                  <valueHelp>
                    <format>enable</format>
                    <description>Inherit Diffie-Hellman group from the IKE group</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group1</format>
                    <description>Use Diffie-Hellman group 1 (modp768)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group2</format>
                    <description>Use Diffie-Hellman group 2 (modp1024)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group5</format>
                    <description>Use Diffie-Hellman group 5 (modp1536)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group14</format>
                    <description>Use Diffie-Hellman group 14 (modp2048)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group15</format>
                    <description>Use Diffie-Hellman group 15 (modp3072)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group16</format>
                    <description>Use Diffie-Hellman group 16 (modp4096)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group17</format>
                    <description>Use Diffie-Hellman group 17 (modp6144)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group18</format>
                    <description>Use Diffie-Hellman group 18 (modp8192)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group19</format>
                    <description>Use Diffie-Hellman group 19 (ecp256)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group20</format>
                    <description>Use Diffie-Hellman group 20 (ecp384)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group21</format>
                    <description>Use Diffie-Hellman group 21 (ecp521)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group22</format>
                    <description>Use Diffie-Hellman group 22 (modp1024s160)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group23</format>
                    <description>Use Diffie-Hellman group 23 (modp2048s224)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group24</format>
                    <description>Use Diffie-Hellman group 24 (modp2048s256)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group25</format>
                    <description>Use Diffie-Hellman group 25 (ecp192)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group26</format>
                    <description>Use Diffie-Hellman group 26 (ecp224)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group27</format>
                    <description>Use Diffie-Hellman group 27 (ecp224bp)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group28</format>
                    <description>Use Diffie-Hellman group 28 (ecp256bp)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group29</format>
                    <description>Use Diffie-Hellman group 29 (ecp384bp)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group30</format>
                    <description>Use Diffie-Hellman group 30 (ecp512bp)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group31</format>
                    <description>Use Diffie-Hellman group 31 (curve25519)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>dh-group32</format>
                    <description>Use Diffie-Hellman group 32 (curve448)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>disable</format>
                    <description>Disable PFS</description>
                  </valueHelp>
                  <constraint>
                    <regex>(enable|dh-group1|dh-group2|dh-group5|dh-group14|dh-group15|dh-group16|dh-group17|dh-group18|dh-group19|dh-group20|dh-group21|dh-group22|dh-group23|dh-group24|dh-group25|dh-group26|dh-group27|dh-group28|dh-group29|dh-group30|dh-group31|dh-group32|disable)</regex>
                  </constraint>
                </properties>
                <defaultValue>enable</defaultValue>
              </leafNode>
              <tagNode name="proposal">
                <properties>
                  <help>ESP group proposal</help>
                  <valueHelp>
                    <format>u32:1-65535</format>
                    <description>ESP group proposal number</description>
                  </valueHelp>
                </properties>
                <children>
                  <!-- include start from vpn-ipsec-encryption.xml.i -->
                  <leafNode name="encryption">
                    <properties>
                      <help>Encryption algorithm</help>
                      <completionHelp>
                        <list>null aes128 aes192 aes256 aes128ctr aes192ctr aes256ctr aes128ccm64 aes192ccm64 aes256ccm64 aes128ccm96 aes192ccm96 aes256ccm96 aes128ccm128 aes192ccm128 aes256ccm128 aes128gcm64 aes192gcm64 aes256gcm64 aes128gcm96 aes192gcm96 aes256gcm96 aes128gcm128 aes192gcm128 aes256gcm128 aes128gmac aes192gmac aes256gmac 3des blowfish128 blowfish192 blowfish256 camellia128 camellia192 camellia256 camellia128ctr camellia192ctr camellia256ctr camellia128ccm64 camellia192ccm64 camellia256ccm64 camellia128ccm96 camellia192ccm96 camellia256ccm96 camellia128ccm128 camellia192ccm128 camellia256ccm128 serpent128 serpent192 serpent256 twofish128 twofish192 twofish256 cast128 chacha20poly1305</list>
                      </completionHelp>
                      <valueHelp>
                        <format>null</format>
                        <description>Null encryption</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128</format>
                        <description>128 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192</format>
                        <description>192 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256</format>
                        <description>256 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ctr</format>
                        <description>128 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ctr</format>
                        <description>192 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ctr</format>
                        <description>256 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm64</format>
                        <description>128 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm64</format>
                        <description>192 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm64</format>
                        <description>256 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm96</format>
                        <description>128 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm96</format>
                        <description>192 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm96</format>
                        <description>256 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm128</format>
                        <description>128 bit AES-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm128</format>
                        <description>192 bit AES-CCM with 128 bit IC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm128</format>
                        <description>256 bit AES-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm64</format>
                        <description>128 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm64</format>
                        <description>192 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm64</format>
                        <description>256 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm96</format>
                        <description>128 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm96</format>
                        <description>192 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm96</format>
                        <description>256 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm128</format>
                        <description>128 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm128</format>
                        <description>192 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm128</format>
                        <description>256 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gmac</format>
                        <description>Null encryption with 128 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gmac</format>
                        <description>Null encryption with 192 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gmac</format>
                        <description>Null encryption with 256 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>3des</format>
                        <description>168 bit 3DES-EDE-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish128</format>
                        <description>128 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish192</format>
                        <description>192 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish256</format>
                        <description>256 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128</format>
                        <description>128 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192</format>
                        <description>192 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256</format>
                        <description>256 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ctr</format>
                        <description>128 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ctr</format>
                        <description>192 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ctr</format>
                        <description>256 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm64</format>
                        <description>128 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm64</format>
                        <description>192 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm64</format>
                        <description>256 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm96</format>
                        <description>128 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm96</format>
                        <description>192 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm96</format>
                        <description>256 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm128</format>
                        <description>128 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm128</format>
                        <description>192 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm128</format>
                        <description>256 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent128</format>
                        <description>128 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent192</format>
                        <description>192 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent256</format>
                        <description>256 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish128</format>
                        <description>128 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish192</format>
                        <description>192 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish256</format>
                        <description>256 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>cast128</format>
                        <description>128 bit CAST-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>chacha20poly1305</format>
                        <description>256 bit ChaCha20/Poly1305 with 128 bit ICV</description>
                      </valueHelp>
                      <constraint>
                        <regex>(null|aes128|aes192|aes256|aes128ctr|aes192ctr|aes256ctr|aes128ccm64|aes192ccm64|aes256ccm64|aes128ccm96|aes192ccm96|aes256ccm96|aes128ccm128|aes192ccm128|aes256ccm128|aes128gcm64|aes192gcm64|aes256gcm64|aes128gcm96|aes192gcm96|aes256gcm96|aes128gcm128|aes192gcm128|aes256gcm128|aes128gmac|aes192gmac|aes256gmac|3des|blowfish128|blowfish192|blowfish256|camellia128|camellia192|camellia256|camellia128ctr|camellia192ctr|camellia256ctr|camellia128ccm64|camellia192ccm64|camellia256ccm64|camellia128ccm96|camellia192ccm96|camellia256ccm96|camellia128ccm128|camellia192ccm128|camellia256ccm128|serpent128|serpent192|serpent256|twofish128|twofish192|twofish256|cast128|chacha20poly1305)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>aes128</defaultValue>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from vpn-ipsec-hash.xml.i -->
                  <leafNode name="hash">
                    <properties>
                      <help>Hash algorithm</help>
                      <completionHelp>
                        <list>md5 md5_128 sha1 sha1_160 sha256 sha256_96 sha384 sha512 aesxcbc aescmac aes128gmac aes192gmac aes256gmac</list>
                      </completionHelp>
                      <valueHelp>
                        <format>md5</format>
                        <description>MD5 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>md5_128</format>
                        <description>MD5_128 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha1</format>
                        <description>SHA1 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha1_160</format>
                        <description>SHA1_160 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha256</format>
                        <description>SHA2_256_128 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha256_96</format>
                        <description>SHA2_256_96 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha384</format>
                        <description>SHA2_384_192 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha512</format>
                        <description>SHA2_512_256 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aesxcbc</format>
                        <description>AES XCBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aescmac</format>
                        <description>AES CMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gmac</format>
                        <description>128-bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gmac</format>
                        <description>192-bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gmac</format>
                        <description>256-bit AES-GMAC</description>
                      </valueHelp>
                      <constraint>
                        <regex>(md5|md5_128|sha1|sha1_160|sha256|sha256_96|sha384|sha512|aesxcbc|aescmac|aes128gmac|aes192gmac|aes256gmac)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>sha1</defaultValue>
                  </leafNode>
                  <!-- include end -->
                </children>
              </tagNode>
            </children>
          </tagNode>
          <tagNode name="ike-group">
            <properties>
              <help>Internet Key Exchange (IKE) group name</help>
            </properties>
            <children>
              <leafNode name="close-action">
                <properties>
                  <help>Action to take if a child SA is unexpectedly closed</help>
                  <completionHelp>
                    <list>none trap start</list>
                  </completionHelp>
                  <valueHelp>
                    <format>none</format>
                    <description>Do nothing</description>
                  </valueHelp>
                  <valueHelp>
                    <format>trap</format>
                    <description>Attempt to re-negotiate when matching traffic is seen</description>
                  </valueHelp>
                  <valueHelp>
                    <format>start</format>
                    <description>Attempt to re-negotiate the connection immediately</description>
                  </valueHelp>
                  <constraint>
                    <regex>(none|trap|start)</regex>
                  </constraint>
                </properties>
                <defaultValue>none</defaultValue>
              </leafNode>
              <node name="dead-peer-detection">
                <properties>
                  <help>Dead Peer Detection (DPD)</help>
                </properties>
                <children>
                  <leafNode name="action">
                    <properties>
                      <help>Keep-alive failure action</help>
                      <completionHelp>
                        <list>trap clear restart</list>
                      </completionHelp>
                      <valueHelp>
                        <format>trap</format>
                        <description>Attempt to re-negotiate the connection when matching traffic is seen</description>
                      </valueHelp>
                      <valueHelp>
                        <format>clear</format>
                        <description>Remove the connection immediately</description>
                      </valueHelp>
                      <valueHelp>
                        <format>restart</format>
                        <description>Attempt to re-negotiate the connection immediately</description>
                      </valueHelp>
                      <constraint>
                        <regex>(trap|clear|restart)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>clear</defaultValue>
                  </leafNode>
                  <leafNode name="interval">
                    <properties>
                      <help>Keep-alive interval</help>
                      <valueHelp>
                        <format>u32:2-86400</format>
                        <description>Keep-alive interval in seconds</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 2-86400"/>
                      </constraint>
                    </properties>
                    <defaultValue>30</defaultValue>
                  </leafNode>
                  <leafNode name="timeout">
                    <properties>
                      <help>Dead Peer Detection keep-alive timeout (IKEv1 only)</help>
                      <valueHelp>
                        <format>u32:2-86400</format>
                        <description>Keep-alive timeout in seconds</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 2-86400"/>
                      </constraint>
                    </properties>
                    <defaultValue>120</defaultValue>
                  </leafNode>
                </children>
              </node>
              <leafNode name="ikev2-reauth">
                <properties>
                  <help>Re-authentication of the remote peer during an IKE re-key (IKEv2 only)</help>
                  <valueless/>
                </properties>
              </leafNode>
              <leafNode name="key-exchange">
                <properties>
                  <help>IKE version</help>
                  <completionHelp>
                    <list>ikev1 ikev2</list>
                  </completionHelp>
                  <valueHelp>
                    <format>ikev1</format>
                    <description>Use IKEv1 for key exchange</description>
                  </valueHelp>
                  <valueHelp>
                    <format>ikev2</format>
                    <description>Use IKEv2 for key exchange</description>
                  </valueHelp>
                  <constraint>
                    <regex>(ikev1|ikev2)</regex>
                  </constraint>
                </properties>
              </leafNode>
              <leafNode name="lifetime">
                <properties>
                  <help>IKE lifetime</help>
                  <valueHelp>
                    <format>u32:0-86400</format>
                    <description>IKE lifetime in seconds</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 0-86400"/>
                  </constraint>
                </properties>
                <defaultValue>28800</defaultValue>
              </leafNode>
              <leafNode name="disable-mobike">
                <properties>
                  <help>Disable MOBIKE Support (IKEv2 only)</help>
                  <valueless/>
                </properties>
              </leafNode>
              <leafNode name="mode">
                <properties>
                  <help>IKEv1 phase 1 mode</help>
                  <completionHelp>
                    <list>main aggressive</list>
                  </completionHelp>
                  <valueHelp>
                    <format>main</format>
                    <description>Use the main mode (recommended)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aggressive</format>
                    <description>Use the aggressive mode (insecure, not recommended)</description>
                  </valueHelp>
                  <constraint>
                    <regex>(main|aggressive)</regex>
                  </constraint>
                </properties>
                <defaultValue>main</defaultValue>
              </leafNode>
              <tagNode name="proposal">
                <properties>
                  <help>IKE proposal</help>
                  <valueHelp>
                    <format>u32:1-65535</format>
                    <description>IKE group proposal</description>
                  </valueHelp>
                </properties>
                <children>
                  <leafNode name="dh-group">
                    <properties>
                      <help>dh-grouphelp</help>
                      <completionHelp>
                        <list>1 2 5 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32</list>
                      </completionHelp>
                      <valueHelp>
                        <format>1</format>
                        <description>Diffie-Hellman group 1 (modp768)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>2</format>
                        <description>Diffie-Hellman group 2 (modp1024)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>5</format>
                        <description>Diffie-Hellman group 5 (modp1536)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>14</format>
                        <description>Diffie-Hellman group 14 (modp2048)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>15</format>
                        <description>Diffie-Hellman group 15 (modp3072)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>16</format>
                        <description>Diffie-Hellman group 16 (modp4096)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>17</format>
                        <description>Diffie-Hellman group 17 (modp6144)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>18</format>
                        <description>Diffie-Hellman group 18 (modp8192)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>19</format>
                        <description>Diffie-Hellman group 19 (ecp256)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>20</format>
                        <description>Diffie-Hellman group 20 (ecp384)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>21</format>
                        <description>Diffie-Hellman group 21 (ecp521)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>22</format>
                        <description>Diffie-Hellman group 22 (modp1024s160)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>23</format>
                        <description>Diffie-Hellman group 23 (modp2048s224)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>24</format>
                        <description>Diffie-Hellman group 24 (modp2048s256)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>25</format>
                        <description>Diffie-Hellman group 25 (ecp192)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>26</format>
                        <description>Diffie-Hellman group 26 (ecp224)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>27</format>
                        <description>Diffie-Hellman group 27 (ecp224bp)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>28</format>
                        <description>Diffie-Hellman group 28 (ecp256bp)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>29</format>
                        <description>Diffie-Hellman group 29 (ecp384bp)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>30</format>
                        <description>Diffie-Hellman group 30 (ecp512bp)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>31</format>
                        <description>Diffie-Hellman group 31 (curve25519)</description>
                      </valueHelp>
                      <valueHelp>
                        <format>32</format>
                        <description>Diffie-Hellman group 32 (curve448)</description>
                      </valueHelp>
                      <constraint>
                        <regex>(1|2|5|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|32)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>2</defaultValue>
                  </leafNode>
                  <leafNode name="prf">
                    <properties>
                      <help>Pseudo-Random Functions</help>
                      <completionHelp>
                        <list>prfmd5 prfsha1 prfaesxcbc prfaescmac prfsha256 prfsha384 prfsha512</list>
                      </completionHelp>
                      <valueHelp>
                        <format>prfmd5</format>
                        <description>MD5 PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfsha1</format>
                        <description>SHA1 PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfaesxcbc</format>
                        <description>AES XCBC PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfaescmac</format>
                        <description>AES CMAC PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfsha256</format>
                        <description>SHA2_256 PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfsha384</format>
                        <description>SHA2_384 PRF</description>
                      </valueHelp>
                      <valueHelp>
                        <format>prfsha512</format>
                        <description>SHA2_512 PRF</description>
                      </valueHelp>
                      <constraint>
                        <regex>(prfmd5|prfsha1|prfaesxcbc|prfaescmac|prfsha256|prfsha384|prfsha512)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include start from vpn-ipsec-encryption.xml.i -->
                  <leafNode name="encryption">
                    <properties>
                      <help>Encryption algorithm</help>
                      <completionHelp>
                        <list>null aes128 aes192 aes256 aes128ctr aes192ctr aes256ctr aes128ccm64 aes192ccm64 aes256ccm64 aes128ccm96 aes192ccm96 aes256ccm96 aes128ccm128 aes192ccm128 aes256ccm128 aes128gcm64 aes192gcm64 aes256gcm64 aes128gcm96 aes192gcm96 aes256gcm96 aes128gcm128 aes192gcm128 aes256gcm128 aes128gmac aes192gmac aes256gmac 3des blowfish128 blowfish192 blowfish256 camellia128 camellia192 camellia256 camellia128ctr camellia192ctr camellia256ctr camellia128ccm64 camellia192ccm64 camellia256ccm64 camellia128ccm96 camellia192ccm96 camellia256ccm96 camellia128ccm128 camellia192ccm128 camellia256ccm128 serpent128 serpent192 serpent256 twofish128 twofish192 twofish256 cast128 chacha20poly1305</list>
                      </completionHelp>
                      <valueHelp>
                        <format>null</format>
                        <description>Null encryption</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128</format>
                        <description>128 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192</format>
                        <description>192 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256</format>
                        <description>256 bit AES-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ctr</format>
                        <description>128 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ctr</format>
                        <description>192 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ctr</format>
                        <description>256 bit AES-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm64</format>
                        <description>128 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm64</format>
                        <description>192 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm64</format>
                        <description>256 bit AES-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm96</format>
                        <description>128 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm96</format>
                        <description>192 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm96</format>
                        <description>256 bit AES-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128ccm128</format>
                        <description>128 bit AES-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192ccm128</format>
                        <description>192 bit AES-CCM with 128 bit IC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256ccm128</format>
                        <description>256 bit AES-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm64</format>
                        <description>128 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm64</format>
                        <description>192 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm64</format>
                        <description>256 bit AES-GCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm96</format>
                        <description>128 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm96</format>
                        <description>192 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm96</format>
                        <description>256 bit AES-GCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gcm128</format>
                        <description>128 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gcm128</format>
                        <description>192 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gcm128</format>
                        <description>256 bit AES-GCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gmac</format>
                        <description>Null encryption with 128 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gmac</format>
                        <description>Null encryption with 192 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gmac</format>
                        <description>Null encryption with 256 bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>3des</format>
                        <description>168 bit 3DES-EDE-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish128</format>
                        <description>128 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish192</format>
                        <description>192 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>blowfish256</format>
                        <description>256 bit Blowfish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128</format>
                        <description>128 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192</format>
                        <description>192 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256</format>
                        <description>256 bit Camellia-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ctr</format>
                        <description>128 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ctr</format>
                        <description>192 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ctr</format>
                        <description>256 bit Camellia-COUNTER</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm64</format>
                        <description>128 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm64</format>
                        <description>192 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm64</format>
                        <description>256 bit Camellia-CCM with 64 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm96</format>
                        <description>128 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm96</format>
                        <description>192 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm96</format>
                        <description>256 bit Camellia-CCM with 96 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia128ccm128</format>
                        <description>128 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia192ccm128</format>
                        <description>192 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>camellia256ccm128</format>
                        <description>256 bit Camellia-CCM with 128 bit ICV</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent128</format>
                        <description>128 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent192</format>
                        <description>192 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>serpent256</format>
                        <description>256 bit Serpent-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish128</format>
                        <description>128 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish192</format>
                        <description>192 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>twofish256</format>
                        <description>256 bit Twofish-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>cast128</format>
                        <description>128 bit CAST-CBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>chacha20poly1305</format>
                        <description>256 bit ChaCha20/Poly1305 with 128 bit ICV</description>
                      </valueHelp>
                      <constraint>
                        <regex>(null|aes128|aes192|aes256|aes128ctr|aes192ctr|aes256ctr|aes128ccm64|aes192ccm64|aes256ccm64|aes128ccm96|aes192ccm96|aes256ccm96|aes128ccm128|aes192ccm128|aes256ccm128|aes128gcm64|aes192gcm64|aes256gcm64|aes128gcm96|aes192gcm96|aes256gcm96|aes128gcm128|aes192gcm128|aes256gcm128|aes128gmac|aes192gmac|aes256gmac|3des|blowfish128|blowfish192|blowfish256|camellia128|camellia192|camellia256|camellia128ctr|camellia192ctr|camellia256ctr|camellia128ccm64|camellia192ccm64|camellia256ccm64|camellia128ccm96|camellia192ccm96|camellia256ccm96|camellia128ccm128|camellia192ccm128|camellia256ccm128|serpent128|serpent192|serpent256|twofish128|twofish192|twofish256|cast128|chacha20poly1305)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>aes128</defaultValue>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from vpn-ipsec-hash.xml.i -->
                  <leafNode name="hash">
                    <properties>
                      <help>Hash algorithm</help>
                      <completionHelp>
                        <list>md5 md5_128 sha1 sha1_160 sha256 sha256_96 sha384 sha512 aesxcbc aescmac aes128gmac aes192gmac aes256gmac</list>
                      </completionHelp>
                      <valueHelp>
                        <format>md5</format>
                        <description>MD5 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>md5_128</format>
                        <description>MD5_128 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha1</format>
                        <description>SHA1 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha1_160</format>
                        <description>SHA1_160 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha256</format>
                        <description>SHA2_256_128 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha256_96</format>
                        <description>SHA2_256_96 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha384</format>
                        <description>SHA2_384_192 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>sha512</format>
                        <description>SHA2_512_256 HMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aesxcbc</format>
                        <description>AES XCBC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aescmac</format>
                        <description>AES CMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes128gmac</format>
                        <description>128-bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes192gmac</format>
                        <description>192-bit AES-GMAC</description>
                      </valueHelp>
                      <valueHelp>
                        <format>aes256gmac</format>
                        <description>256-bit AES-GMAC</description>
                      </valueHelp>
                      <constraint>
                        <regex>(md5|md5_128|sha1|sha1_160|sha256|sha256_96|sha384|sha512|aesxcbc|aescmac|aes128gmac|aes192gmac|aes256gmac)</regex>
                      </constraint>
                    </properties>
                    <defaultValue>sha1</defaultValue>
                  </leafNode>
                  <!-- include end -->
                </children>
              </tagNode>
            </children>
          </tagNode>
          <!-- include start from generic-interface-multi.xml.i -->
          <leafNode name="interface">
            <properties>
              <help>Interface to use</help>
              <completionHelp>
                <script>${vyos_completion_dir}/list_interfaces</script>
              </completionHelp>
              <valueHelp>
                <format>txt</format>
                <description>Interface name</description>
              </valueHelp>
              <constraint>
                <!-- include start from constraint/interface-name.xml.i -->
                <regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
                <validator name="file-path --lookup-path /sys/class/net --directory"/>
                <!-- include end -->
              </constraint>
              <multi/>
            </properties>
          </leafNode>
          <!-- include end -->
          <node name="log">
            <properties>
              <help>IPsec logging</help>
            </properties>
            <children>
              <leafNode name="level">
                <properties>
                  <help>Global IPsec logging Level</help>
                  <valueHelp>
                    <format>0</format>
                    <description>Very basic auditing logs (e.g., SA up/SA down)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>1</format>
                    <description>Generic control flow with errors, a good default to see whats going on</description>
                  </valueHelp>
                  <valueHelp>
                    <format>2</format>
                    <description>More detailed debugging control flow</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 0-2"/>
                  </constraint>
                </properties>
                <defaultValue>0</defaultValue>
              </leafNode>
              <leafNode name="subsystem">
                <properties>
                  <help>Subsystem logging levels</help>
                  <completionHelp>
                    <list>dmn mgr ike chd job cfg knl net asn enc lib esp tls tnc imc imv pts any</list>
                  </completionHelp>
                  <valueHelp>
                    <format>dmn</format>
                    <description>Main daemon setup/cleanup/signal handling</description>
                  </valueHelp>
                  <valueHelp>
                    <format>mgr</format>
                    <description>IKE_SA manager, handling synchronization for IKE_SA access</description>
                  </valueHelp>
                  <valueHelp>
                    <format>ike</format>
                    <description>IKE_SA/ISAKMP SA</description>
                  </valueHelp>
                  <valueHelp>
                    <format>chd</format>
                    <description>CHILD_SA/IPsec SA</description>
                  </valueHelp>
                  <valueHelp>
                    <format>job</format>
                    <description>Jobs queuing/processing and thread pool management</description>
                  </valueHelp>
                  <valueHelp>
                    <format>cfg</format>
                    <description>Configuration management and plugins</description>
                  </valueHelp>
                  <valueHelp>
                    <format>knl</format>
                    <description>IPsec/Networking kernel interface</description>
                  </valueHelp>
                  <valueHelp>
                    <format>net</format>
                    <description>IKE network communication</description>
                  </valueHelp>
                  <valueHelp>
                    <format>asn</format>
                    <description>Low-level encoding/decoding (ASN.1, X.509 etc.)</description>
                  </valueHelp>
                  <valueHelp>
                    <format>enc</format>
                    <description>Packet encoding/decoding encryption/decryption operations</description>
                  </valueHelp>
                  <valueHelp>
                    <format>lib</format>
                    <description>libstrongswan library messages</description>
                  </valueHelp>
                  <valueHelp>
                    <format>esp</format>
                    <description>libipsec library messages</description>
                  </valueHelp>
                  <valueHelp>
                    <format>tls</format>
                    <description> libtls library messages</description>
                  </valueHelp>
                  <valueHelp>
                    <format>tnc</format>
                    <description>Trusted Network Connect</description>
                  </valueHelp>
                  <valueHelp>
                    <format>imc</format>
                    <description>Integrity Measurement Collector</description>
                  </valueHelp>
                  <valueHelp>
                    <format>imv</format>
                    <description>Integrity Measurement Verifier</description>
                  </valueHelp>
                  <valueHelp>
                    <format>pts</format>
                    <description> Platform Trust Service</description>
                  </valueHelp>
                  <valueHelp>
                    <format>any</format>
                    <description>Any subsystem</description>
                  </valueHelp>
                  <constraint>
                    <regex>(dmn|mgr|ike|chd|job|cfg|knl|net|asn|enc|lib|esp|tls|tnc|imc|imv|pts|any)</regex>
                  </constraint>
                  <multi/>
                </properties>
              </leafNode>
            </children>
          </node>
          <node name="options">
            <properties>
              <help>Global IPsec settings</help>
            </properties>
            <children>
              <leafNode name="disable-route-autoinstall">
                <properties>
                  <help>Do not automatically install routes to remote networks</help>
                  <valueless/>
                </properties>
              </leafNode>
              <leafNode name="flexvpn">
                <properties>
                  <help>Allow FlexVPN vendor ID payload (IKEv2 only)</help>
                  <valueless/>
                </properties>
              </leafNode>
              <!-- include start from generic-interface.xml.i -->
              <leafNode name="interface">
                <properties>
                  <help>Interface to use</help>
                  <completionHelp>
                    <script>${vyos_completion_dir}/list_interfaces</script>
                  </completionHelp>
                  <valueHelp>
                    <format>txt</format>
                    <description>Interface name</description>
                  </valueHelp>
                  <constraint>
                    <!-- include start from constraint/interface-name.xml.i -->
                    <regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
                    <validator name="file-path --lookup-path /sys/class/net --directory"/>
                    <!-- include end -->
                  </constraint>
                </properties>
              </leafNode>
              <!-- include end -->
              <leafNode name="virtual-ip">
                <properties>
                  <help>Allow install virtual-ip addresses</help>
                  <valueless/>
                </properties>
              </leafNode>
            </children>
          </node>
          <tagNode name="profile">
            <properties>
              <help>VPN IPsec profile</help>
              <valueHelp>
                <format>txt</format>
                <description>Profile name</description>
              </valueHelp>
              <constraint>
                <regex>[a-zA-Z][0-9a-zA-Z_-]+</regex>
              </constraint>
              <constraintErrorMessage>Profile name must be alphanumeric and can contain hyphen(s) and underscore(s)</constraintErrorMessage>
            </properties>
            <children>
              <!-- include start from generic-disable-node.xml.i -->
              <leafNode name="disable">
                <properties>
                  <help>Disable instance</help>
                  <valueless/>
                </properties>
              </leafNode>
              <!-- include end -->
              <node name="authentication">
                <properties>
                  <help>Authentication</help>
                </properties>
                <children>
                  <leafNode name="mode">
                    <properties>
                      <help>Authentication mode</help>
                      <completionHelp>
                        <list>pre-shared-secret</list>
                      </completionHelp>
                      <valueHelp>
                        <format>pre-shared-secret</format>
                        <description>Use a pre-shared secret key</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                  <!-- include start from ipsec/authentication-pre-shared-secret.xml.i -->
                  <leafNode name="pre-shared-secret">
                    <properties>
                      <help>Pre-shared secret key</help>
                      <valueHelp>
                        <format>txt</format>
                        <description>Pre-shared secret key</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                </children>
              </node>
              <node name="bind">
                <properties>
                  <help>DMVPN tunnel configuration</help>
                </properties>
                <children>
                  <leafNode name="tunnel">
                    <properties>
                      <help>Tunnel interface associated with this profile</help>
                      <completionHelp>
                        <path>interfaces tunnel</path>
                      </completionHelp>
                      <valueHelp>
                        <format>txt</format>
                        <description>Associated interface to this profile</description>
                      </valueHelp>
                      <multi/>
                    </properties>
                  </leafNode>
                </children>
              </node>
              <!-- include start from ipsec/esp-group.xml.i -->
              <leafNode name="esp-group">
                <properties>
                  <help>Encapsulating Security Payloads (ESP) group name</help>
                  <completionHelp>
                    <path>vpn ipsec esp-group</path>
                  </completionHelp>
                </properties>
              </leafNode>
              <!-- include end -->
              <!-- include start from ipsec/ike-group.xml.i -->
              <leafNode name="ike-group">
                <properties>
                  <help>Internet Key Exchange (IKE) group name</help>
                  <completionHelp>
                    <path>vpn ipsec ike-group</path>
                  </completionHelp>
                </properties>
              </leafNode>
              <!-- include end -->
            </children>
          </tagNode>
          <node name="remote-access">
            <properties>
              <help>IKEv2 remote access VPN</help>
            </properties>
            <children>
              <tagNode name="connection">
                <properties>
                  <help>IKEv2 VPN connection name</help>
                  <valueHelp>
                    <format>txt</format>
                    <description>Connection name</description>
                  </valueHelp>
                  <constraint>
                    <regex>[a-zA-Z][0-9a-zA-Z_-]+</regex>
                  </constraint>
                  <constraintErrorMessage>Profile name must be alphanumeric and can contain hyphen(s) and underscore(s)</constraintErrorMessage>
                </properties>
                <children>
                  <node name="authentication">
                    <properties>
                      <help>Authentication for remote access</help>
                    </properties>
                    <children>
                      <!-- include start from ipsec/authentication-id.xml.i -->
                      <leafNode name="local-id">
                        <properties>
                          <help>Local ID for peer authentication</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>Local ID used for peer authentication</description>
                          </valueHelp>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from ipsec/authentication-x509.xml.i -->
                      <node name="x509">
                        <properties>
                          <help>X.509 certificate</help>
                        </properties>
                        <children>
                          <!-- include start from pki/certificate-key.xml.i -->
                          <!-- include start from pki/certificate.xml.i -->
                          <leafNode name="certificate">
                            <properties>
                              <help>Certificate in PKI configuration</help>
                              <completionHelp>
                                <path>pki certificate</path>
                              </completionHelp>
                              <valueHelp>
                                <format>txt</format>
                                <description>Name of certificate in PKI configuration</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <leafNode name="passphrase">
                            <properties>
                              <help>Private key passphrase</help>
                              <valueHelp>
                                <format>txt</format>
                                <description>Passphrase to decrypt the private key</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <!-- include start from pki/ca-certificate.xml.i -->
                          <leafNode name="ca-certificate">
                            <properties>
                              <help>Certificate Authority in PKI configuration</help>
                              <completionHelp>
                                <path>pki ca</path>
                              </completionHelp>
                              <valueHelp>
                                <format>txt</format>
                                <description>Name of CA in PKI configuration</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                        </children>
                      </node>
                      <!-- include end -->
                      <leafNode name="client-mode">
                        <properties>
                          <help>Client authentication mode</help>
                          <completionHelp>
                            <list>x509 eap-tls eap-mschapv2 eap-radius</list>
                          </completionHelp>
                          <valueHelp>
                            <format>x509</format>
                            <description>Use IPsec x.509 certificate authentication</description>
                          </valueHelp>
                          <valueHelp>
                            <format>eap-tls</format>
                            <description>Use EAP-TLS authentication</description>
                          </valueHelp>
                          <valueHelp>
                            <format>eap-mschapv2</format>
                            <description>Use EAP-MSCHAPv2 authentication</description>
                          </valueHelp>
                          <valueHelp>
                            <format>eap-radius</format>
                            <description>Use EAP-RADIUS authentication</description>
                          </valueHelp>
                          <constraint>
                            <regex>(x509|eap-tls|eap-mschapv2|eap-radius)</regex>
                          </constraint>
                        </properties>
                        <defaultValue>eap-mschapv2</defaultValue>
                      </leafNode>
                      <!-- include start from auth-local-users.xml.i -->
                      <node name="local-users">
                        <properties>
                          <help>Local user authentication</help>
                        </properties>
                        <children>
                          <tagNode name="username">
                            <properties>
                              <help>Username used for authentication</help>
                              <valueHelp>
                                <format>txt</format>
                                <description>Username used for authentication</description>
                              </valueHelp>
                            </properties>
                            <children>
                              <!-- include start from generic-disable-node.xml.i -->
                              <leafNode name="disable">
                                <properties>
                                  <help>Disable instance</help>
                                  <valueless/>
                                </properties>
                              </leafNode>
                              <!-- include end -->
                              <leafNode name="password">
                                <properties>
                                  <help>Password used for authentication</help>
                                </properties>
                              </leafNode>
                            </children>
                          </tagNode>
                        </children>
                      </node>
                      <!-- include end -->
                      <leafNode name="server-mode">
                        <properties>
                          <help>Server authentication mode</help>
                          <completionHelp>
                            <list>pre-shared-secret x509</list>
                          </completionHelp>
                          <valueHelp>
                            <format>pre-shared-secret</format>
                            <description>Use a pre-shared secret key</description>
                          </valueHelp>
                          <valueHelp>
                            <format>x509</format>
                            <description>Use x.509 certificate</description>
                          </valueHelp>
                          <constraint>
                            <regex>(pre-shared-secret|x509)</regex>
                          </constraint>
                        </properties>
                        <defaultValue>x509</defaultValue>
                      </leafNode>
                      <!-- include start from ipsec/authentication-pre-shared-secret.xml.i -->
                      <leafNode name="pre-shared-secret">
                        <properties>
                          <help>Pre-shared secret key</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>Pre-shared secret key</description>
                          </valueHelp>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                    </children>
                  </node>
                  <!-- include start from generic-description.xml.i -->
                  <leafNode name="description">
                    <properties>
                      <help>Description</help>
                      <valueHelp>
                        <format>txt</format>
                        <description>Description</description>
                      </valueHelp>
                      <constraint>
                        <regex>[[:ascii:]]{0,256}</regex>
                      </constraint>
                      <constraintErrorMessage>Description too long (limit 256 characters)</constraintErrorMessage>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from generic-disable-node.xml.i -->
                  <leafNode name="disable">
                    <properties>
                      <help>Disable instance</help>
                      <valueless/>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/esp-group.xml.i -->
                  <leafNode name="esp-group">
                    <properties>
                      <help>Encapsulating Security Payloads (ESP) group name</help>
                      <completionHelp>
                        <path>vpn ipsec esp-group</path>
                      </completionHelp>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/ike-group.xml.i -->
                  <leafNode name="ike-group">
                    <properties>
                      <help>Internet Key Exchange (IKE) group name</help>
                      <completionHelp>
                        <path>vpn ipsec ike-group</path>
                      </completionHelp>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/local-address.xml.i -->
                  <leafNode name="local-address">
                    <properties>
                      <help>IPv4 or IPv6 address of a local interface to use for VPN</help>
                      <completionHelp>
                        <list>any</list>
                        <script>${vyos_completion_dir}/list_local_ips.sh --both</script>
                      </completionHelp>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 address of a local interface for VPN</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>IPv6 address of a local interface for VPN</description>
                      </valueHelp>
                      <valueHelp>
                        <format>any</format>
                        <description>Allow any IPv4 address present on the system to be used for VPN</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-address"/>
                        <regex>(any)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/local-traffic-selector.xml.i -->
                  <node name="local">
                    <properties>
                      <help>Local parameters for interesting traffic</help>
                    </properties>
                    <children>
                      <!-- include start from port-number.xml.i -->
                      <leafNode name="port">
                        <properties>
                          <help>Port number used by connection</help>
                          <valueHelp>
                            <format>u32:1-65535</format>
                            <description>Numeric IP port</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                          <constraintErrorMessage>Port number must be in range 1 to 65535</constraintErrorMessage>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <leafNode name="prefix">
                        <properties>
                          <help>Local IPv4 or IPv6 prefix</help>
                          <valueHelp>
                            <format>ipv4net</format>
                            <description>Local IPv4 prefix</description>
                          </valueHelp>
                          <valueHelp>
                            <format>ipv6net</format>
                            <description>Local IPv6 prefix</description>
                          </valueHelp>
                          <constraint>
                            <validator name="ipv4-prefix"/>
                            <validator name="ipv6-prefix"/>
                          </constraint>
                          <multi/>
                        </properties>
                      </leafNode>
                    </children>
                  </node>
                  <!-- include end -->
                  <!-- include start from ipsec/replay-window.xml.i -->
                  <leafNode name="replay-window">
                    <properties>
                      <help>IPsec replay window to configure for this CHILD_SA</help>
                      <valueHelp>
                        <format>u32:0</format>
                        <description>Disable IPsec replay protection</description>
                      </valueHelp>
                      <valueHelp>
                        <format>u32:1-2040</format>
                        <description>Replay window size in packets</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 0-2040"/>
                      </constraint>
                    </properties>
                    <defaultValue>32</defaultValue>
                  </leafNode>
                  <!-- include end -->
                  <leafNode name="timeout">
                    <properties>
                      <help>Timeout to close connection if no data is transmitted</help>
                      <valueHelp>
                        <format>u32:0</format>
                        <description>Disable inactivity checks</description>
                      </valueHelp>
                      <valueHelp>
                        <format>u32:1-86400</format>
                        <description>Timeout in seconds</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 0-86400"/>
                      </constraint>
                    </properties>
                    <defaultValue>28800</defaultValue>
                  </leafNode>
                  <leafNode name="pool">
                    <properties>
                      <help>IP address pool</help>
                      <completionHelp>
                        <path>vpn ipsec remote-access pool</path>
                        <list>dhcp radius</list>
                      </completionHelp>
                      <valueHelp>
                        <format>txt</format>
                        <description>Predefined IP pool name</description>
                      </valueHelp>
                      <valueHelp>
                        <format>dhcp</format>
                        <description>Forward requests for virtual IP addresses to a DHCP server</description>
                      </valueHelp>
                      <valueHelp>
                        <format>radius</format>
                        <description>Forward requests for virtual IP addresses to a RADIUS server</description>
                      </valueHelp>
                      <multi/>
                    </properties>
                  </leafNode>
                  <leafNode name="unique">
                    <properties>
                      <help>Connection uniqueness enforcement policy</help>
                      <completionHelp>
                        <list>never keep replace</list>
                      </completionHelp>
                      <valueHelp>
                        <format>never</format>
                        <description>Never enforce connection uniqueness</description>
                      </valueHelp>
                      <valueHelp>
                        <format>keep</format>
                        <description>Reject new connection attempts if the same user already has an active connection</description>
                      </valueHelp>
                      <valueHelp>
                        <format>replace</format>
                        <description>Delete any existing connection if a new one for the same user gets established</description>
                      </valueHelp>
                      <constraint>
                        <regex>(never|keep|replace)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                </children>
              </tagNode>
              <node name="dhcp">
                <properties>
                  <help>DHCP pool options for remote access</help>
                </properties>
                <children>
                  <!-- include start from generic-interface.xml.i -->
                  <leafNode name="interface">
                    <properties>
                      <help>Interface to use</help>
                      <completionHelp>
                        <script>${vyos_completion_dir}/list_interfaces</script>
                      </completionHelp>
                      <valueHelp>
                        <format>txt</format>
                        <description>Interface name</description>
                      </valueHelp>
                      <constraint>
                        <!-- include start from constraint/interface-name.xml.i -->
                        <regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
                        <validator name="file-path --lookup-path /sys/class/net --directory"/>
                        <!-- include end -->
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <leafNode name="server">
                    <properties>
                      <help>DHCP server address</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>DHCP server IPv4 address</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                    </properties>
                  </leafNode>
                </children>
              </node>
              <tagNode name="pool">
                <properties>
                  <help>IP address pool for remote access users</help>
                </properties>
                <children>
                  <leafNode name="exclude">
                    <properties>
                      <help>Local IPv4 or IPv6 pool prefix exclusions</help>
                      <valueHelp>
                        <format>ipv4net</format>
                        <description>Local IPv4 pool prefix exclusion</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6net</format>
                        <description>Local IPv6 pool prefix exclusion</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv4-prefix"/>
                        <validator name="ipv6-prefix"/>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <leafNode name="prefix">
                    <properties>
                      <help>Local IPv4 or IPv6 pool prefix</help>
                      <valueHelp>
                        <format>ipv4net</format>
                        <description>Local IPv4 pool prefix</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6net</format>
                        <description>Local IPv6 pool prefix</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv4-prefix"/>
                        <validator name="ipv6-prefix"/>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include start from name-server-ipv4-ipv6.xml.i -->
                  <leafNode name="name-server">
                    <properties>
                      <help>Domain Name Servers (DNS) addresses</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>Domain Name Server (DNS) IPv4 address</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>Domain Name Server (DNS) IPv6 address</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-address"/>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                </children>
              </tagNode>
              <!-- include start from radius-auth-server-ipv4.xml.i -->
              <node name="radius">
                <properties>
                  <help>RADIUS based user authentication</help>
                </properties>
                <children>
                  <!-- include start from source-address-ipv4.xml.i -->
                  <leafNode name="source-address">
                    <properties>
                      <help>IPv4 source address used to initiate connection</help>
                      <completionHelp>
                        <script>${vyos_completion_dir}/list_local_ips.sh --ipv4</script>
                      </completionHelp>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 source address</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <tagNode name="server">
                    <properties>
                      <help>RADIUS server configuration</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>RADIUS server IPv4 address</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                    </properties>
                    <children>
                      <!-- include start from generic-disable-node.xml.i -->
                      <leafNode name="disable">
                        <properties>
                          <help>Disable instance</help>
                          <valueless/>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from radius-server-key.xml.i -->
                      <leafNode name="key">
                        <properties>
                          <help>Shared secret key</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>Password string (key)</description>
                          </valueHelp>
                          <constraint>
                            <regex>[[:ascii:]]{1,128}</regex>
                          </constraint>
                          <constraintErrorMessage>Password must be less then 128 characters</constraintErrorMessage>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from radius-server-auth-port.xml.i -->
                      <!-- include start from port-number.xml.i -->
                      <leafNode name="port">
                        <properties>
                          <help>Port number used by connection</help>
                          <valueHelp>
                            <format>u32:1-65535</format>
                            <description>Numeric IP port</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                          <constraintErrorMessage>Port number must be in range 1 to 65535</constraintErrorMessage>
                        </properties>
                        <defaultValue>1812</defaultValue>
                      </leafNode>
                      <!-- include end -->
                      <!-- include end -->
                    </children>
                  </tagNode>
                </children>
              </node>
              <!-- include end -->
              <node name="radius">
                <children>
                  <!-- include start from radius-nas-identifier.xml.i -->
                  <leafNode name="nas-identifier">
                    <properties>
                      <help>NAS-Identifier attribute sent to RADIUS</help>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from radius-timeout.xml.i -->
                  <leafNode name="timeout">
                    <properties>
                      <help>Session timeout</help>
                      <valueHelp>
                        <format>u32:1-240</format>
                        <description>Session timeout in seconds (default: 2)</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 1-240"/>
                      </constraint>
                      <constraintErrorMessage>Timeout must be between 1 and 240 seconds</constraintErrorMessage>
                    </properties>
                    <defaultValue>2</defaultValue>
                  </leafNode>
                  <!-- include end -->
                  <tagNode name="server">
                    <children>
                      <!-- include start from accel-ppp/radius-additions-disable-accounting.xml.i -->
                      <leafNode name="disable-accounting">
                        <properties>
                          <help>Disable accounting</help>
                          <valueless/>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                    </children>
                  </tagNode>
                </children>
              </node>
            </children>
          </node>
          <node name="site-to-site">
            <properties>
              <help>Site-to-site VPN</help>
            </properties>
            <children>
              <tagNode name="peer">
                <properties>
                  <help>Connection name of the peer</help>
                  <valueHelp>
                    <format>txt</format>
                    <description>Connection name of the peer</description>
                  </valueHelp>
                  <constraint>
                    <regex>[-_a-zA-Z0-9|@]+</regex>
                  </constraint>
                  <constraintErrorMessage>Peer connection name must be alphanumeric and can contain hyphen and underscores</constraintErrorMessage>
                </properties>
                <children>
                  <!-- include start from generic-disable-node.xml.i -->
                  <leafNode name="disable">
                    <properties>
                      <help>Disable instance</help>
                      <valueless/>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <node name="authentication">
                    <properties>
                      <help>Peer authentication</help>
                    </properties>
                    <children>
                      <!-- include start from ipsec/authentication-id.xml.i -->
                      <leafNode name="local-id">
                        <properties>
                          <help>Local ID for peer authentication</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>Local ID used for peer authentication</description>
                          </valueHelp>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from ipsec/authentication-rsa.xml.i -->
                      <node name="rsa">
                        <properties>
                          <help>RSA keys</help>
                        </properties>
                        <children>
                          <leafNode name="local-key">
                            <properties>
                              <help>Name of PKI key-pair with local private key</help>
                              <completionHelp>
                                <path>pki key-pair</path>
                              </completionHelp>
                            </properties>
                          </leafNode>
                          <leafNode name="passphrase">
                            <properties>
                              <help>Local private key passphrase</help>
                            </properties>
                          </leafNode>
                          <leafNode name="remote-key">
                            <properties>
                              <help>Name of PKI key-pair with remote public key</help>
                              <completionHelp>
                                <path>pki key-pair</path>
                              </completionHelp>
                            </properties>
                          </leafNode>
                        </children>
                      </node>
                      <!-- include end -->
                      <!-- include start from ipsec/authentication-x509.xml.i -->
                      <node name="x509">
                        <properties>
                          <help>X.509 certificate</help>
                        </properties>
                        <children>
                          <!-- include start from pki/certificate-key.xml.i -->
                          <!-- include start from pki/certificate.xml.i -->
                          <leafNode name="certificate">
                            <properties>
                              <help>Certificate in PKI configuration</help>
                              <completionHelp>
                                <path>pki certificate</path>
                              </completionHelp>
                              <valueHelp>
                                <format>txt</format>
                                <description>Name of certificate in PKI configuration</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <leafNode name="passphrase">
                            <properties>
                              <help>Private key passphrase</help>
                              <valueHelp>
                                <format>txt</format>
                                <description>Passphrase to decrypt the private key</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <!-- include start from pki/ca-certificate.xml.i -->
                          <leafNode name="ca-certificate">
                            <properties>
                              <help>Certificate Authority in PKI configuration</help>
                              <completionHelp>
                                <path>pki ca</path>
                              </completionHelp>
                              <valueHelp>
                                <format>txt</format>
                                <description>Name of CA in PKI configuration</description>
                              </valueHelp>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                        </children>
                      </node>
                      <!-- include end -->
                      <leafNode name="mode">
                        <properties>
                          <help>Authentication mode</help>
                          <completionHelp>
                            <list>pre-shared-secret rsa x509</list>
                          </completionHelp>
                          <valueHelp>
                            <format>pre-shared-secret</format>
                            <description>Use pre-shared secret key</description>
                          </valueHelp>
                          <valueHelp>
                            <format>rsa</format>
                            <description>Use RSA key</description>
                          </valueHelp>
                          <valueHelp>
                            <format>x509</format>
                            <description>Use x.509 certificate</description>
                          </valueHelp>
                          <constraint>
                            <regex>(pre-shared-secret|rsa|x509)</regex>
                          </constraint>
                        </properties>
                      </leafNode>
                      <leafNode name="remote-id">
                        <properties>
                          <help>ID for remote authentication</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>ID used for peer authentication</description>
                          </valueHelp>
                        </properties>
                        <defaultValue>%any</defaultValue>
                      </leafNode>
                      <leafNode name="use-x509-id">
                        <properties>
                          <help>Use certificate common name as ID</help>
                          <valueless/>
                        </properties>
                      </leafNode>
                    </children>
                  </node>
                  <leafNode name="connection-type">
                    <properties>
                      <help>Connection type</help>
                      <completionHelp>
                        <list>initiate respond none</list>
                      </completionHelp>
                      <valueHelp>
                        <format>initiate</format>
                        <description>Bring the connection up immediately</description>
                      </valueHelp>
                      <valueHelp>
                        <format>respond</format>
                        <description>Wait for the peer to initiate the connection</description>
                      </valueHelp>
                      <valueHelp>
                        <format>none</format>
                        <description>Load the connection only</description>
                      </valueHelp>
                      <constraint>
                        <regex>(initiate|respond|none)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                  <leafNode name="default-esp-group">
                    <properties>
                      <help>Defult ESP group name</help>
                      <completionHelp>
                        <path>vpn ipsec esp-group</path>
                      </completionHelp>
                    </properties>
                  </leafNode>
                  <!-- include start from generic-description.xml.i -->
                  <leafNode name="description">
                    <properties>
                      <help>Description</help>
                      <valueHelp>
                        <format>txt</format>
                        <description>Description</description>
                      </valueHelp>
                      <constraint>
                        <regex>[[:ascii:]]{0,256}</regex>
                      </constraint>
                      <constraintErrorMessage>Description too long (limit 256 characters)</constraintErrorMessage>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <leafNode name="dhcp-interface">
                    <properties>
                      <help>DHCP interface supplying next-hop IP address</help>
                      <completionHelp>
                        <script>${vyos_completion_dir}/list_interfaces</script>
                      </completionHelp>
                      <valueHelp>
                        <format>txt</format>
                        <description>DHCP interface name</description>
                      </valueHelp>
                      <constraint>
                        <!-- include start from constraint/interface-name.xml.i -->
                        <regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
                        <validator name="file-path --lookup-path /sys/class/net --directory"/>
                        <!-- include end -->
                      </constraint>
                    </properties>
                  </leafNode>
                  <leafNode name="force-udp-encapsulation">
                    <properties>
                      <help>Force UDP encapsulation</help>
                      <valueless/>
                    </properties>
                  </leafNode>
                  <!-- include start from ipsec/ike-group.xml.i -->
                  <leafNode name="ike-group">
                    <properties>
                      <help>Internet Key Exchange (IKE) group name</help>
                      <completionHelp>
                        <path>vpn ipsec ike-group</path>
                      </completionHelp>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <leafNode name="ikev2-reauth">
                    <properties>
                      <help>Re-authentication of the remote peer during an IKE re-key (IKEv2 only)</help>
                      <completionHelp>
                        <list>yes no inherit</list>
                      </completionHelp>
                      <valueHelp>
                        <format>yes</format>
                        <description>Enable remote host re-autentication during an IKE re-key. Currently broken due to a strong swan bug</description>
                      </valueHelp>
                      <valueHelp>
                        <format>no</format>
                        <description>Disable remote host re-authenticaton during an IKE re-key.</description>
                      </valueHelp>
                      <valueHelp>
                        <format>inherit</format>
                        <description>Inherit the reauth configuration form your IKE-group</description>
                      </valueHelp>
                      <constraint>
                        <regex>(yes|no|inherit)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include start from ipsec/local-address.xml.i -->
                  <leafNode name="local-address">
                    <properties>
                      <help>IPv4 or IPv6 address of a local interface to use for VPN</help>
                      <completionHelp>
                        <list>any</list>
                        <script>${vyos_completion_dir}/list_local_ips.sh --both</script>
                      </completionHelp>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 address of a local interface for VPN</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>IPv6 address of a local interface for VPN</description>
                      </valueHelp>
                      <valueHelp>
                        <format>any</format>
                        <description>Allow any IPv4 address present on the system to be used for VPN</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-address"/>
                        <regex>(any)</regex>
                      </constraint>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/remote-address.xml.i -->
                  <leafNode name="remote-address">
                    <properties>
                      <help>IPv4 or IPv6 address of the remote peer</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 address of the remote peer</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>IPv6 address of the remote peer</description>
                      </valueHelp>
                      <valueHelp>
                        <format>hostname</format>
                        <description>Fully qualified domain name of the remote peer</description>
                      </valueHelp>
                      <valueHelp>
                        <format>any</format>
                        <description>Allow any IP address of the remote peer</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-address"/>
                        <validator name="fqdn"/>
                        <regex>(any)</regex>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <!-- include end -->
                  <!-- include start from ipsec/replay-window.xml.i -->
                  <leafNode name="replay-window">
                    <properties>
                      <help>IPsec replay window to configure for this CHILD_SA</help>
                      <valueHelp>
                        <format>u32:0</format>
                        <description>Disable IPsec replay protection</description>
                      </valueHelp>
                      <valueHelp>
                        <format>u32:1-2040</format>
                        <description>Replay window size in packets</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 0-2040"/>
                      </constraint>
                    </properties>
                    <defaultValue>32</defaultValue>
                  </leafNode>
                  <!-- include end -->
                  <tagNode name="tunnel">
                    <properties>
                      <help>Peer tunnel</help>
                      <valueHelp>
                        <format>u32</format>
                        <description>Peer tunnel</description>
                      </valueHelp>
                    </properties>
                    <children>
                      <!-- include start from generic-disable-node.xml.i -->
                      <leafNode name="disable">
                        <properties>
                          <help>Disable instance</help>
                          <valueless/>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from ipsec/esp-group.xml.i -->
                      <leafNode name="esp-group">
                        <properties>
                          <help>Encapsulating Security Payloads (ESP) group name</help>
                          <completionHelp>
                            <path>vpn ipsec esp-group</path>
                          </completionHelp>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                      <!-- include start from ipsec/local-traffic-selector.xml.i -->
                      <node name="local">
                        <properties>
                          <help>Local parameters for interesting traffic</help>
                        </properties>
                        <children>
                          <!-- include start from port-number.xml.i -->
                          <leafNode name="port">
                            <properties>
                              <help>Port number used by connection</help>
                              <valueHelp>
                                <format>u32:1-65535</format>
                                <description>Numeric IP port</description>
                              </valueHelp>
                              <constraint>
                                <validator name="numeric" argument="--range 1-65535"/>
                              </constraint>
                              <constraintErrorMessage>Port number must be in range 1 to 65535</constraintErrorMessage>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <leafNode name="prefix">
                            <properties>
                              <help>Local IPv4 or IPv6 prefix</help>
                              <valueHelp>
                                <format>ipv4net</format>
                                <description>Local IPv4 prefix</description>
                              </valueHelp>
                              <valueHelp>
                                <format>ipv6net</format>
                                <description>Local IPv6 prefix</description>
                              </valueHelp>
                              <constraint>
                                <validator name="ipv4-prefix"/>
                                <validator name="ipv6-prefix"/>
                              </constraint>
                              <multi/>
                            </properties>
                          </leafNode>
                        </children>
                      </node>
                      <!-- include end -->
                      <!-- include start from ip-protocol.xml.i -->
                      <leafNode name="protocol">
                        <properties>
                          <help>Protocol</help>
                          <valueHelp>
                            <format>txt</format>
                            <description>Protocol name</description>
                          </valueHelp>
                          <completionHelp>
                            <script>${vyos_completion_dir}/list_protocols.sh</script>
                          </completionHelp>
                          <constraint>
                            <validator name="ip-protocol"/>
                          </constraint>
                        </properties>
                      </leafNode>
                      <!-- include end from ip-protocol.xml.i -->
                      <leafNode name="priority">
                        <properties>
                          <help>Priority for IPsec policy (lowest value more preferable)</help>
                          <valueHelp>
                            <format>u32:1-100</format>
                            <description>Priority for IPsec policy (lowest value more preferable)</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-100"/>
                          </constraint>
                        </properties>
                      </leafNode>
                      <node name="remote">
                        <properties>
                          <help>Match remote addresses</help>
                        </properties>
                        <children>
                          <!-- include start from port-number.xml.i -->
                          <leafNode name="port">
                            <properties>
                              <help>Port number used by connection</help>
                              <valueHelp>
                                <format>u32:1-65535</format>
                                <description>Numeric IP port</description>
                              </valueHelp>
                              <constraint>
                                <validator name="numeric" argument="--range 1-65535"/>
                              </constraint>
                              <constraintErrorMessage>Port number must be in range 1 to 65535</constraintErrorMessage>
                            </properties>
                          </leafNode>
                          <!-- include end -->
                          <leafNode name="prefix">
                            <properties>
                              <help>Remote IPv4 or IPv6 prefix</help>
                              <valueHelp>
                                <format>ipv4net</format>
                                <description>Remote IPv4 prefix</description>
                              </valueHelp>
                              <valueHelp>
                                <format>ipv6net</format>
                                <description>Remote IPv6 prefix</description>
                              </valueHelp>
                              <constraint>
                                <validator name="ipv4-prefix"/>
                                <validator name="ipv6-prefix"/>
                              </constraint>
                              <multi/>
                            </properties>
                          </leafNode>
                        </children>
                      </node>
                    </children>
                  </tagNode>
                  <leafNode name="virtual-address">
                    <properties>
                      <help>Initiator request virtual-address from peer</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>Request IPv4 address from peer</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>Request IPv6 address from peer</description>
                      </valueHelp>
                      <multi/>
                    </properties>
                  </leafNode>
                  <node name="vti">
                    <properties>
                      <help>Virtual tunnel interface</help>
                    </properties>
                    <children>
                      <leafNode name="bind">
                        <properties>
                          <help>VTI tunnel interface associated with this configuration</help>
                          <completionHelp>
                            <path>interfaces vti</path>
                          </completionHelp>
                        </properties>
                      </leafNode>
                      <!-- include start from ipsec/esp-group.xml.i -->
                      <leafNode name="esp-group">
                        <properties>
                          <help>Encapsulating Security Payloads (ESP) group name</help>
                          <completionHelp>
                            <path>vpn ipsec esp-group</path>
                          </completionHelp>
                        </properties>
                      </leafNode>
                      <!-- include end -->
                    </children>
                  </node>
                </children>
              </tagNode>
            </children>
          </node>
        </children>
      </node>
    </children>
  </node>
</interfaceDefinition>
